<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MR Sim Track Editor</title>
    <link rel="stylesheet" href="styles.css" />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"
      
    ></script>
    <script src="objects.js" defer></script>
    <script src="editor.js" defer></script>
  </head>
  <body>
    <header class="app-header">
      <h1>MRSim Track Editor (Prototype)</h1>
      <div class="header-actions">
        <button id="import-button" type="button">Import XML</button>
        <button id="export-button" class="primary">Export XML</button>
        <input id="import-file-input" type="file" accept=".xml" hidden />
      </div>
    </header>
    <main class="app-layout">
      <section class="sidebar sidebar-left" data-sidebar="left">
        <div class="panel panel-selected">
          <h2>Object Palette</h2>
          <div id="object-palette" class="palette"></div>
        </div>
      </section>
      <section class="canvas-area">
        <div class="canvas-toolbar">
          <div class="toolbar-actions">
            <button id="toggle-references" type="button">Hide Reference Layout</button>
            <button id="reset-view" type="button">Reset View</button>
            <button id="clear-scene" type="button" class="danger">
              Clear Scene
            </button>
            <button id="toggle-snapping" type="button" class="secondary" aria-pressed="true">
              Snapping On
            </button>
            <button id="measure-toggle" type="button" class="secondary" aria-pressed="false">
              Ruler Off
            </button>
          </div>
          <div class="zoom-controls" role="group" aria-label="Canvas zoom controls">
            <button id="zoom-out" type="button" aria-label="Zoom out">-</button>
            <input
              id="zoom-slider"
              type="range"
              min="40"
              max="250"
              step="1"
              value="50"
              aria-label="Zoom level"
            />
            <button id="zoom-in" type="button" aria-label="Zoom in">+</button>
            <span id="zoom-value" aria-live="polite">50%</span>
          </div>
          <button id="toggle-sidebars" type="button" class="secondary" aria-pressed="false">
            Hide Sidebars
          </button>
        </div>
        <div class="canvas-wrapper">
          <canvas id="track-canvas" width="750" height="800"></canvas>
        </div>
      </section>
      <section class="sidebar sidebar-right" data-sidebar="right">
        <div class="panel">
          <h2>Snapping</h2>
          <label class="field">
            <span>Grid size (m)</span>
            <input
              id="grid-size-input"
              type="number"
              min="0.1"
              step="0.1"
              value="0.7"
            />
          </label>
          <label class="field">
            <span>Rotation snap (°)</span>
            <input
              id="rotation-snap-input"
              type="number"
              min="1"
              step="1"
              value="5"
            />
          </label>
        </div>
        <div class="panel">
          <h2>Global Transform</h2>
          <label class="field">
            <span>Offset X (m)</span>
            <input id="global-offset-x" type="number" step="0.1" value="0" />
          </label>
          <label class="field">
            <span>Offset Y (m)</span>
            <input id="global-offset-y" type="number" step="0.1" value="0" />
          </label>
          <label class="field">
            <span>Rotation (°)</span>
            <input id="global-rotation" type="number" step="1" value="0" />
          </label>
        </div>
        <div class="panel selected-panel">
          <h2>Selected Object</h2>
          <div class="selected-panel__body">
            <div id="selected-none" class="selected-empty">
              No object selected.
            </div>
            <div id="selected-details" class="selected-details hidden">
              <div class="field readonly">
                <span>Label</span>
                <span id="selected-label"></span>
              </div>
              <div id="selected-preview-wrapper" class="selected-preview hidden">
                <img id="selected-preview" alt="Selected object preview" />
              </div>
              <div class="field readonly">
                <span>Entity name</span>
                <span id="selected-entity"></span>
              </div>
              <div class="field readonly">
                <span>Position X (m)</span>
                <span id="selected-position-x">0.000</span>
              </div>
              <div class="field readonly">
                <span>Position Y (m)</span>
                <span id="selected-position-y">0.000</span>
              </div>
              <div class="field readonly">
                <span>Rotation (°)</span>
                <span id="selected-rotation">0</span>
              </div>
              <label class="field">
                <span>Altitude (m)</span>
                <input id="selected-altitude" type="number" step="0.1" value="0" />
              </label>
              <div id="gate-stack-controls" class="attachment-controls hidden">
                <label class="field">
                  <span>5x5 Gate Stack</span>
                  <select id="gate-stack-count">
                    <option value="1">1 gate</option>
                    <option value="2">2 gates</option>
                    <option value="3">3 gates</option>
                  </select>
                </label>
              </div>
              <div class="field readonly">
                <span>Include file</span>
                <span id="selected-include"></span>
              </div>
              <div id="attachment-controls" class="attachment-controls hidden">
                <label class="field">
                  <span>Attach to Gate</span>
                  <select id="attach-gate-select">
                    <option value="">None (Standalone)</option>
                  </select>
                </label>
                <label class="field">
                  <span>Attachment Side</span>
                  <select id="attach-side-select">
                    <option value="left">Left</option>
                    <option value="right">Right</option>
                  </select>
                </label>
                <label class="field">
                  <span>Attach Gate Level</span>
                  <select id="attach-level-select">
                    <option value="1">Gate 1</option>
                  </select>
                </label>
              </div>
              <div class="selected-actions">
                <button id="duplicate-button" type="button">Duplicate</button>
                <button id="delete-button" type="button" class="danger">
                  Delete
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </body>
</html>

